<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Dash Jetpack Mode</title>
    <style>
        body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background: #1a1a1a; font-family: 'Courier New', Courier, monospace; overflow: hidden; }
        canvas { background: #222; border: 3px solid #00ffcc; }
        #ui { position: absolute; top: 20px; color: #00ffcc; font-size: 24px; text-shadow: 2px 2px #000; }
    </style>
</head>
<body>
    <div id="ui">PONTOS: 0</div>
    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const ui = document.getElementById('ui');

    canvas.width = 800;
    canvas.height = 400;

    let score = 0;
    let gameActive = true;
    let frame = 0;
    let isPressing = false; // Estado da tecla

    const player = {
        x: 80,
        y: 200,
        size: 30,
        dy: 0,
        gravity: 0.5,
        thrust: 0.8, // Força do Jetpack
        maxSpeed: 7
    };

    const obstacles = [];

    // Captura de comandos (teclado e mouse/touch)
    window.addEventListener('keydown', (e) => { if (e.code === 'Space') isPressing = true; });
    window.addEventListener('keyup', (e) => { if (e.code === 'Space') isPressing = false; });
    window.addEventListener('mousedown', () => isPressing = true);
    window.addEventListener('mouseup', () => isPressing = false);

    function resetGame() {
        score = 0;
        obstacles.length = 0;
        player.y = 200;
        player.dy = 0;
        gameActive = true;
        ui.innerText = `PONTOS: 0`;
        loop();
    }

    function spawnObstacle() {
        const speed = 4 + Math.random() * 6;
        const type = Math.random() > 0.5 ? 'top' : 'bottom';
        
        obstacles.push({
            x: canvas.width,
            y: type === 'top' ? 0 : canvas.height - 80,
            width: 30,
            height: 80 + Math.random() * 100,
            speed: speed,
            color: '#ff0055'
        });
    }

    function update() {
        // Lógica do Jetpack
        if (isPressing) {
            player.dy -= player.thrust; // Sobe
        } else {
            player.dy += player.gravity; // Cai
        }

        // Limite de velocidade
        if (player.dy > player.maxSpeed) player.dy = player.maxSpeed;
        if (player.dy < -player.maxSpeed) player.dy = -player.maxSpeed;

        player.y += player.dy;

        // Colisão com teto e chão
        if (player.y < 0 || player.y + player.size > canvas.height) {
            gameActive = false;
        }

        // Obstáculos
        if (frame % 60 === 0) spawnObstacle();

        for (let i = obstacles.length - 1; i >= 0; i--) {
            const obs = obstacles[i];
            obs.x -= obs.speed;

            // Colisão com obstáculos
            if (player.x < obs.x + obs.width &&
                player.x + player.size > obs.x &&
                player.y < obs.y + obs.height &&
                player.y + player.size > obs.y) {
                gameActive = false;
            }

            if (obs.x + obs.width < 0) {
                obstacles.splice(i, 1);
                score++;
                ui.innerText = `PONTOS: ${score}`;
            }
        }
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Desenhar rastro/partículas se estiver subindo
        if (isPressing) {
            ctx.fillStyle = '#ff9900';
            ctx.fillRect(player.x - 10, player.y + 10, 10, 10);
        }

        // Jogador (Nave)
        ctx.fillStyle = '#00ffcc';
        ctx.fillRect(player.x, player.y, player.size, player.size);
        
        // Detalhe da nave
        ctx.fillStyle = 'white';
        ctx.fillRect(player.x + 20, player.y + 5, 8, 8);

        // Obstáculos (Espinhos/Blocos)
        obstacles.forEach(obs => {
            ctx.fillStyle = obs.color;
            ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
            // Borda do obstáculo
            ctx.strokeStyle = 'white';
            ctx.strokeRect(obs.x, obs.y, obs.width, obs.height);
        });

        if (!gameActive) {
            ctx.fillStyle = 'rgba(0,0,0,0.8)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#00ffcc';
            ctx.textAlign = 'center';
            ctx.font = '40px Courier New';
            ctx.fillText('FIM DE JOGO', canvas.width/2, canvas.height/2);
            ctx.font = '20px Courier New';
            ctx.fillText('Pressione ou Clique para reiniciar', canvas.width/2, canvas.height/2 + 50);
        }
    }

    function loop() {
        if (!gameActive) {
            draw();
            // Permite reiniciar ao clicar após morrer
            window.onclick = () => { if(!gameActive) resetGame(); };
            return;
        }
        update();
        draw();
        frame++;
        requestAnimationFrame(loop);
    }

    loop();
</script>
</body>
</html>